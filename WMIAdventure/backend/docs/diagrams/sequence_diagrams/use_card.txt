title Use Card

activate Empty

# Use card call

activate Player

Empty->Player: use_card()

# Get next card to use

activate Deck

Player->Deck: get_card()

Player<--Deck: card: BattleCard

deactivate Deck

# Use card

activate BattleCard

Player->BattleCard: use()

## Update effects

activate BattleCard

BattleCard->BattleCard: update_effects()

loop for effect in effects

### Call update on effect

activate Effect

BattleCard->Effect: update()

	#### Update buffs

    activate Effect

    Effect->Effect: update_buffs()

    loop for buf in buffs

      activate Buff

      Effect->Buff:update()

      Buff->Buff: tick()

      deactivate Buff
    
    end

    Effect->Effect: __remove_expired__buffs__()

    deactivate Effect

deactivate Effect

end

deactivate BattleCard

## Update effects - end

Player<--BattleCard: effects: Effect[*]

deactivate BattleCard

# Return

Empty<--Player: effects: Effect[*]

deactivate Player
